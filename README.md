# 딥러닝과 기술적 분석을 융합한 비트코인 알고리즘 트레이딩

> GRU 모델의 예측 신뢰도와 RSI 지표를 활용한 리스크 관리 중심의 하이브리드 전략 연구

## 1. 프로젝트 개요 및 동기

비트코인 시장은 24시간 열려 있고 변동성이 극심하여, 사람이 직접 대응하기에는 체력적, 심리적 한계가 명확합니다. 따라서 감정을 배제하고 철저히 데이터에 기반하여 매매를 수행하는 알고리즘 트레이딩 시스템의 필요성을 느꼈습니다.

단순히 "내일 가격이 오를까?"를 맞추는 것은 동전 던지기와 다를 바 없습니다. 본 프로젝트의 핵심 목표는 "언제 확실하게 배팅하고, 언제 시장을 관망해야 하는가?"를 판단하는 의사결정 시스템을 구축하는 것입니다. 이를 위해 시계열 패턴 학습에 강한 딥러닝 모델(GRU)을 엔진으로 사용하고, 시장의 과열 여부를 판단하는 보조지표(RSI)를 브레이크로 사용하는 복합 전략을 설계했습니다.

- 작성자: 서채영 (202201750)
- 제출일: 2025년 12월 13일

---

## 2. 컴퓨팅 환경 (Hardware Specification)

본 프로젝트는 대용량 시계열 데이터 학습과 딥러닝 모델의 빠른 추론을 위해 GPU 가속 환경에서 수행되었습니다.

- CPU: Intel Xeon Processors @ 2.20GHz (2 vCPUs)
- GPU: NVIDIA Tesla T4 (16GB GDDR6 VRAM) - CUDA 11.8 지원
- RAM: 12GB ~ 25GB (High-RAM Runtime)
- OS: Ubuntu 20.04.6 LTS
- Framework: PyTorch 2.0.1+cu118

---

## 3. 데이터 전처리 및 입력 변수

모델이 가격 흐름을 입체적으로 이해할 수 있도록 단순 가격 데이터 외에 다양한 시장 정보를 피처로 가공하여 주입했습니다.

* 기초 데이터: 시가, 고가, 저가, 종가, 거래량 (OHLCV)
* 추세 지표: 이동평균선의 골든크로스/데드크로스 패턴 학습을 위한 기간별 이동평균 값
* 모멘텀 지표: 상대강도지수(RSI), MACD 등을 통해 현재 추세의 강도를 수치화
* 변동성 지표: 볼린저 밴드 등의 변동성 정보를 추가하여 시장 급변 감지

---

## 4. 모델 설계: 왜 GRU인가?

초기에는 가장 대중적인 LSTM 모델을 고려했으나, 실험 결과 GRU(Gated Recurrent Unit)가 본 프로젝트에 더 적합하다고 판단했습니다.

### 4.1 아키텍처 선정 이유 및 구조
비트코인 데이터는 노이즈가 많아 지나치게 복잡한 모델은 오히려 독이 될 수 있습니다. GRU는 LSTM보다 구조가 단순하여 파라미터 수가 적고, 과적합 위험을 줄이면서도 연산 속도가 빠릅니다.

단순한 1계층 모델은 복잡한 금융 시장의 비선형성을 담아내기에 역부족이었습니다. 따라서 2개의 층(Layers)을 쌓아 1층에서는 단순 패턴을, 2층에서는 복잡한 추상 패턴을 학습하도록 설계했습니다. 또한 은닉 노드(Hidden Units)를 128개로 설정하여 정보 수용량을 늘리고, 0.3의 드롭아웃(Dropout)을 적용하여 과적합을 방지했습니다.

```python
import torch.nn as nn
import torch.optim as optim
class MyTradingModel(nn.Module):
    """
    GRU 기반의 트레이딩 모델
    입력: (batch, sequence_length, features)
    출력: (batch, 1) - 상승 확률 (0~1)
    """
    def __init__(self, input_size, hidden_size=128, num_layers=2, dropout=0.3):
        super(MyTradingModel, self).__init__()
        
        # 1. GRU 레이어 (LSTM보다 학습 속도가 빠름)
        self.gru = nn.GRU(
            input_size=input_size, 
            hidden_size=hidden_size, 
            num_layers=num_layers, 
            batch_first=True, 
            dropout=dropout
        )
        
        # 2. 분류기 (Classifier)
        self.fc = nn.Sequential(
            nn.Linear(hidden_size, 32),
            nn.ReLU(),
            nn.Dropout(dropout),
            nn.Linear(32, 1),
            nn.Sigmoid()  # 0~1 사이 확률 출력
        )
        
    def forward(self, x):
        # x shape: (batch_size, seq_len, input_size)
        out, _ = self.gru(x)
        
        # 마지막 시점(Last time step)의 Hidden State만 사용
        # out shape: (batch_size, seq_len, hidden_size)
        last_step_out = out[:, -1, :] 
        
        # 분류기 통과
        prediction = self.fc(last_step_out)
        return prediction

# 모델 생성 (GPU 사용)
my_model = MyTradingModel(
    input_size=X_train_seq.shape[2],
    hidden_size=128, 
    num_layers=2,
    dropout=0.3
).to(device)
```

---

## 5. 트레이딩 전략: AI와 보조지표의 하이브리드
딥러닝 모델은 간혹 시장의 급변 구간에서 엉뚱한 예측을 할 때가 있습니다. 이를 보완하기 위해 AI가 추천하고, 기술적 지표가 승인해야만 매매한다는 이중 필터링 전략(Level 4)을 세웠습니다.

### 5.1 전략 로직 상세
제 전략은 다음 두 가지 조건이 동시에 충족될 때만 매수를 진행합니다.

첫째, 모델 예측 확률이 50% 초반대인 구간은 노이즈일 가능성이 높아 진입하지 않고, 확률이 65% 이상인 확실한 구간만 선별합니다. 

둘째, AI가 상승을 예측했더라도 현재 RSI 지표가 70 이상(과매수)이라면 고점 매수 위험을 고려하여 투자 비중을 절반(50%)으로 축소하여 리스크를 관리합니다. 반대로 RSI가 30 이하(과매도)인 구간에서는 기술적 반등 확률이 높으므로, 모델의 확신도가 조금 낮더라도(40% 이상) 소액 진입하거나 비중을 1.5배 확대하여 적극적으로 수익을 추구합니다

```python
# 1. 기본 비중 (모델 확률 기반)
if prob > threshold:
    base_ratio = min(prob * 1.2, 1.0) # 확률의 1.2배 투자 (최대 100%)
else:
    base_ratio = 0
    
# 2. RSI 보정
if rsi > 70: # 과매수 -> 비중 축소
    final_ratio = base_ratio * 0.5
elif rsi < 30: # 과매도 -> 비중 확대
    final_ratio = min(base_ratio * 1.5, 1.0)
    # 모델 확신이 부족해도 RSI가 낮으면 소액 진입
    if prob > 0.4 and base_ratio == 0:
        final_ratio = 0.3
else:
    final_ratio = base_ratio
```

---

## 6. 실험 결과 및 성과 분석
2024년 이후의 검증 데이터를 사용하여 백테스팅을 진행했습니다.

### 6.1 수익률 비교 분석
단순 보유 전략(Buy & Hold)은 시장 상황 부진으로 +2.42%의 낮은 수익률을 기록한 반면, 제안된 모델 전략은 +8.31%의 수익률을 달성했습니다. 이는 벤치마크 대비 약 3.4배 높은 성과이며, +5.89%p의 초과 수익(Alpha)을 창출했음을 의미합니다.

### 6.2 시행착오와 최적화
처음부터 좋은 결과가 나온 것은 아닙니다. 초기 시도에서 진입 확신도를 0.5(50%)로 설정했을 때는 잦은 매매(285회)로 인해 수수료가 누적되어 수익이 마이너스였습니다. 이에 "거래 횟수를 줄이더라도 확실할 때만 들어가자"는 가설을 세우고 임계값을 0.65로 올렸습니다. 그 결과 거래 횟수는 149회로 줄었지만, 손익비가 획기적으로 개선되며 수익 전환에 성공했습니다.

### 6.3 리스크 관리 성과
단순 보유 전략은 하락장에서 계좌가 손실을 입는 것을 지켜봐야 했지만, 제 전략은 하락 시그널이 감지되거나 확신도가 낮을 때 전량 현금화를 선택했습니다. 덕분에 하락장의 손실을 방어하고, 이후 상승장에서 수익을 쌓아가는 우상향 계단식 자산 곡선을 그릴 수 있었습니다.

---

## 7. 결론 및 향후 연구 과제
이번 프로젝트는 단순히 딥러닝 모델을 돌려보는 것을 넘어, 실제 트레이딩에서 수익을 내기 위해 어떤 고민이 필요한지를 깨닫는 과정이었습니다. 특히 모델의 정확도보다 중요한 것은 대응 전략이라는 사실을 배웠습니다.

하지만 아쉬운 점도 있습니다. 금융 시장의 노이즈로 인해 모델의 기본 예측 정확도는 50% 중반대에 머물렀습니다. 향후에는 최신 어텐션 메커니즘인 트랜스포머(Transformer)를 도입하여 시계열 데이터의 장기 의존성을 더 잘 포착하거나, 뉴스 기사의 감성 지수 및 온체인 데이터를 입력 변수로 추가하여 차트 밖의 정보까지 반영하는 방향으로 모델을 개선해보고 싶습니다. 또한 실전 매매를 가정하여 슬리피지 비용을 모델링에 포함하고, 급락 시 자산을 보호할 자동 손절매 로직을 추가할 계획입니다.
